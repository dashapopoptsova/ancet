# DOCX анкеты: автоматическое заполнение

Скрипт `fill_docx.py` подставляет значения из JSON в DOCX-шаблон, сохраняя форматирование Word-документа.

## Что поддерживается

- Подстановка текста в поля через Jinja2-плейсхолдеры (например, `{{ full_name }}`) или через `field("путь.к.полю")` для вложенного JSON.
- Варианты выбора/чекбоксы через функцию `checkbox()`.
- Условные блоки через Jinja2 `{% if ... %}`.
- (Опционально) вставка изображений подписи/печати через `images`.

## Установка

```bash
pip install -r requirements.txt
```

## Использование

```bash
python fill_docx.py template.docx filled_fields.json result.docx
```

## Формат JSON

```json
{
  "компания": {
    "основные_реквизиты": {
      "полное_название": "Акционерное общество «Ромашка»"
    }
  },
  "руководство": {
    "генеральный_директор": {
      "фио": "Ромашкина Ромашка Ромашкович"
    }
  },
  "совет_директоров": [
    {
      "фио": "Фиалкина Фиалка Ф"
    }
  ],
  "choices": {
    "basis": "charter",
    "representative_role": ["director"]
  },
  "images": {
    "signature": {
      "path": "assets/signature.png",
      "width_mm": 40
    }
  },
  "empty_placeholder": "—",
  "checkbox_symbols": {
    "checked": "☑",
    "unchecked": "☐"
  }
}
```

## Пример разметки шаблона

```text
Полное наименование: {{ field("компания.основные_реквизиты.полное_название") }}
ФИО руководителя: {{ field("руководство.генеральный_директор.фио") }}
Первый член совета директоров: {{ field("совет_директоров[0].фио") }}

Основание полномочий:
{{ checkbox("basis", "charter") }} Устав
{{ checkbox("basis", "power_of_attorney") }} Доверенность

{% if is_foreigner %}
Гражданство: {{ value(citizenship) }}
{% endif %}

Подпись: {{ signature }}
```

> `value()` подставит `empty_placeholder`, если значение пустое/`null`.
> `field()` принимает путь с точками и индексами списка (`[0]`).
